---
title: ' Evaluation of NO2 emission with different land-use pattern within different states in the US'
keywords:
- markdown
- publishing
- manubot
lang: en-US
date-meta: '2024-10-27'
author-meta:
- Siyoung Park
- Tausif E Elahi
- Tabassum Nanzeeba
- Rauf Momina
header-includes: |
  <!--
  Manubot generated metadata rendered from header-includes-template.html.
  Suggest improvements at https://github.com/manubot/manubot/blob/main/manubot/process/header-includes-template.html
  -->
  <meta name="dc.format" content="text/html" />
  <meta property="og:type" content="article" />
  <meta name="dc.title" content=" Evaluation of NO2 emission with different land-use pattern within different states in the US" />
  <meta name="citation_title" content=" Evaluation of NO2 emission with different land-use pattern within different states in the US" />
  <meta property="og:title" content=" Evaluation of NO2 emission with different land-use pattern within different states in the US" />
  <meta property="twitter:title" content=" Evaluation of NO2 emission with different land-use pattern within different states in the US" />
  <meta name="dc.date" content="2024-10-27" />
  <meta name="citation_publication_date" content="2024-10-27" />
  <meta property="article:published_time" content="2024-10-27" />
  <meta name="dc.modified" content="2024-11-18T16:22:39+00:00" />
  <meta property="article:modified_time" content="2024-11-18T16:22:39+00:00" />
  <meta name="dc.language" content="en-US" />
  <meta name="citation_language" content="en-US" />
  <meta name="dc.relation.ispartof" content="Manubot" />
  <meta name="dc.publisher" content="Manubot" />
  <meta name="citation_journal_title" content="Manubot" />
  <meta name="citation_technical_report_institution" content="Manubot" />
  <meta name="citation_author" content="Siyoung Park" />
  <meta name="citation_author_institution" content="Department of Civil and Environmental Engineering, University of Illinois Urbana-Champaign" />
  <meta name="citation_author_orcid" content="None" />
  <meta name="citation_author" content="Tausif E Elahi" />
  <meta name="citation_author_institution" content="-Department of Civil and Environmental Engineering, University of Illinois Urbana-Champaign" />
  <meta name="citation_author_orcid" content="None" />
  <meta name="citation_author" content="Tabassum Nanzeeba" />
  <meta name="citation_author_institution" content="Department of Civil and Environmental Engineering, University of Illinois Urbana-Champaign" />
  <meta name="citation_author_orcid" content="None" />
  <meta name="citation_author" content="Rauf Momina" />
  <meta name="citation_author_institution" content="Department of Civil and Environmental Engineering, University of Illinois Urbana-Champaign" />
  <meta name="citation_author_orcid" content="None" />
  <link rel="canonical" href="https://uiceds.github.io/project-team492/" />
  <meta property="og:url" content="https://uiceds.github.io/project-team492/" />
  <meta property="twitter:url" content="https://uiceds.github.io/project-team492/" />
  <meta name="citation_fulltext_html_url" content="https://uiceds.github.io/project-team492/" />
  <meta name="citation_pdf_url" content="https://uiceds.github.io/project-team492/manuscript.pdf" />
  <link rel="alternate" type="application/pdf" href="https://uiceds.github.io/project-team492/manuscript.pdf" />
  <link rel="alternate" type="text/html" href="https://uiceds.github.io/project-team492/v/9f2e5a41ead6b30e0e5ae344a7bbc7e618248638/" />
  <meta name="manubot_html_url_versioned" content="https://uiceds.github.io/project-team492/v/9f2e5a41ead6b30e0e5ae344a7bbc7e618248638/" />
  <meta name="manubot_pdf_url_versioned" content="https://uiceds.github.io/project-team492/v/9f2e5a41ead6b30e0e5ae344a7bbc7e618248638/manuscript.pdf" />
  <meta property="og:type" content="article" />
  <meta property="twitter:card" content="summary_large_image" />
  <link rel="icon" type="image/png" sizes="192x192" href="https://manubot.org/favicon-192x192.png" />
  <link rel="mask-icon" href="https://manubot.org/safari-pinned-tab.svg" color="#ad1457" />
  <meta name="theme-color" content="#ad1457" />
  <!-- end Manubot generated metadata -->
bibliography:
- content/manual-references.json
manubot-output-bibliography: output/references.json
manubot-output-citekeys: output/citations.tsv
manubot-requests-cache-path: ci/cache/requests-cache
manubot-clear-requests-cache: false
...






<small><em>
This manuscript
([permalink](https://uiceds.github.io/project-team492/v/9f2e5a41ead6b30e0e5ae344a7bbc7e618248638/))
was automatically generated
from [uiceds/project-team492@9f2e5a4](https://github.com/uiceds/project-team492/tree/9f2e5a41ead6b30e0e5ae344a7bbc7e618248638)
on November 18, 2024.
</em></small>

Published: October 27, 2024


## Authors



+ **Siyoung Park**
  ^[✉](#correspondence)^<br>
    · ![GitHub icon](images/github.svg){.inline_icon width=16 height=16}
    [siyoung3](https://github.com/siyoung3)
    <br>
  <small>
     Department of Civil and Environmental Engineering, University of Illinois Urbana-Champaign
  </small>

+ **Tausif E Elahi**
  ^[✉](#correspondence)^<br>
    · ![GitHub icon](images/github.svg){.inline_icon width=16 height=16}
    [tausifeelahi](https://github.com/tausifeelahi)
    <br>
  <small>
     -Department of Civil and Environmental Engineering, University of Illinois Urbana-Champaign
  </small>

+ **Tabassum Nanzeeba**
  ^[✉](#correspondence)^<br>
    · ![GitHub icon](images/github.svg){.inline_icon width=16 height=16}
    [nanxee492](https://github.com/nanxee492)
    <br>
  <small>
     Department of Civil and Environmental Engineering, University of Illinois Urbana-Champaign
  </small>

+ **Rauf Momina**
  ^[✉](#correspondence)^<br>
    · ![GitHub icon](images/github.svg){.inline_icon width=16 height=16}
    [MominaRauf](https://github.com/MominaRauf)
    <br>
  <small>
     Department of Civil and Environmental Engineering, University of Illinois Urbana-Champaign
  </small>


::: {#correspondence}
✉ — Correspondence possible via [GitHub Issues](https://github.com/uiceds/project-team492/issues)
or email to
Siyoung Park \<siyoung3@illinois.edu\>, 
Tausif E Elahi \<tausife2@illinois.edu\>, 
Tabassum Nanzeeba \<nt23@illinois.edu\>, 
Rauf Momina \<momina2@illinois.edu\>.


:::


## Project Description {.page_break_before}

__Description of data set:__ 

_The dataset consists of_ 

1.	Air pollutants (O<sub>3</sub>, CO, SO<sub>2</sub>, NO<sub>2</sub>, PM10) in different states (Illinois, California, Florida, North Dakota). of the US
- CSV file 1 Rows: 463,218 // Cols: 7

A data set shows air pollutant concentrations for 5 criteria i.e. O<sub>3</sub>, CO, SO<sub>2</sub>, NO<sub>2</sub>, and PM10. The variable “pred_weight” shows concentrations of pollutants in µg/m³. The title lat and lon represent the latitude and longitude of the specific place where the data were measured and noted. O<sub>3</sub> and CO are measured as parts per million (ppm) whereas NO<sub>2</sub> and SO<sub>2</sub> are measured as parts per billion (ppb).

Threshold for pollutants:

O<sub>3</sub>, CO, SO<sub>2</sub>, NO<sub>2</sub> and PM10 concentration thresholds are based on standards set by WHO (World Health Organization) and EPA (Environmental Protection Agency).

-	O<sub>3</sub>: 0.070 ppm exposure for 8 hours.

-	CO: 9 ppm (8 hours) and 35 ppm (1 hour).
> Not to be exceeded more than once per year

-	SO<sub>2</sub>: 75 ppb (1 hour, 3 years average) and 0.5 ppm (3 hours, year)

-	NO<sub>2</sub>: 100 ppb (1 hour, 3 years average) and 53 ppb (year, annual mean)

-	PM10: 150 µg/m³ (24 hours, 3 years average)

_Dataset:_
https://www.caces.us/data [Accessed: 09/19/2024]
In a CSV file


# {.page_break_before}
2.	Temperature variation of the above states over years (using NOAA, National Centers for Environmental Information dataset from 1991 to 2020).
-	CSV file 1 (Bismarck 2.4 NNW, ND, US)
Rows: 13 // Cols: 313
-	CSV file 2 (Springfield Capital AP, IL, US)
Rows: 13 // Cols: 413
-	CSV file 3 (Tallahassee AP, FL, US)
Rows: 13 // Cols: 413
-	CSV file 4 (Sacramento, CA, US)
Rows: 13 // Cols: 385

_A data set of 4 cities i.e. capital cities of four selected states of the US. The information of capital cities of selected states is given below_ 

| *Regions* | State              | City        |
|:----------|:-------------------|:------------|
| 1         | North Dakota (ND)  | Bismarck    | 
| 2         | Mid Illinois (IL)  | Springfield | 
| 3         | South Florida (FL) | Tallahassee | 
| 4         | California (CA)    | Sacramento  | 

The dataset consists of temperature variations in the abovementioned cities from 1991 to 2020. CSV file includes daily max, daily min, mean, standard deviation, cooling degree days, heating degree days, and mean number of days. The data are given in every month from 1991 to 2020.

_Dataset:_
Palecki, Michael; Durre, Imke; Applequist, Scott; Arguez, Anothony; Lawrimore, Jay. 2021: U.S. Climate Normals 2020: U.S. Hourly Climate Normals (1991-2020). [indicate subset used]. NOAA National Centers for Environmental Information. https/doi.org/. Accessed [09/19/2024]
In a CSV file

# {.page_break_before}
__Proposal:__ 

1.	In this research, our team will track the air pollutants in different states of the US. O<sub>3</sub>, CO, SO<sub>2</sub>, NO<sub>2</sub>, and PM10 are the subjects of the investigation. The five states of the US, North Dakota (north), Illinois (mid), Florida (south), and California (west) are the regions for measuring air pollutants.
  
2.	The historical trend (temperature change) of the air pollutants will also be investigated along with the US State data. From 1991 to 2020, the variation of climate (such as mean temperature by months) and air pollutants will be compared to evaluate their correlation.

3.	The ultimate goal of this research will be to alert each investigated States of increasing air pollutant and to come up with ideas for mitigating them. Also, the monthly temperature and air pollutants will be compared to notice when the air pollutants are maximized with an understanding of their distribution.


## Exploratory Data Analysis {.page_break_before}
   
__Description and Characterization of Dataset__ 

<p style="text-align:justify;">

The dataset we are going to use is obtained from Bechle et al. [1] which was used for estimating air pollution in terms of NO<sub>2</sub> from 2000 to 2010. The dataset contains spatial and temporal concentration of NO<sub>2</sub> in ppb at different locations of the different states in US. It also contains Geographic Information System (GIS) data on land-use features such as impervious surfaces, population density, length of different types of roads-residential, major and total etc. These are commonly used as proxies for different pollution sources [2-4]. Based on the dataset, NO<sub>2</sub> concentration varies significantly from state to state depending on different land-use pattern and the value range between 0.31~34.21 ppb for different states. The distribution of the NO<sub>2</sub> pollutants across the US based on location are shown in Figure 1. Some of the explanations of the dataset are provided below:

Impervious_100: This represents the percentage of impervious surfaces such as roads, buildings etc. within a 100-meter buffer around the measuring station.
Major_1000: It refers to the length of the major roads within a 1-kilometer radius around the measuring location.
Resident_500: This indicates length of the roads within 500-meter radius of the monitoring station.
Total_100: It represents the length of all the roads including major, minor and residential within a 100-meter buffer zone around the measuring station.
Population_100: It denotes the population density within the 100-meter buffer area around the measuring station.


_Dataset CSV file:_
https://docs.google.com/spreadsheets/d/1yo3cL23279-qwrjHSDbHc1e4t_8yl6h8CfVrMX-PIS4/edit?usp=drive_web&ouid=116140173519287299300


<figure style="text-align: center;">
    <img src="https://raw.githubusercontent.com/uiceds/project-team492/refs/heads/main/content/images/Figure%201.png" alt="Sample Image">
    <figcaption><strong>Figure 1:</strong> Distribution of NO<sub>2</sub> pollutants across the US based on latitude and longitude of monitoring stations.</figcaption>
</figure>


# {.page_break_before}
__Preliminary Analysis and Plots__ 

From the given dataset, we did some preliminary analysis to visualize the dataset and the summary of the observations are described briefly:
First, we tried to find out if there is any direct relationship between any of the land use characteristics and NO<sub>2</sub> concentrations measured at the monitor station. For this preliminary analysis, we considered the effect of this land use pattern within 100m, 5000m and 10000m radius of the station. The reason for selecting these three radii was to cover short, medium and long-distance land use behavior around the station. Figure 2-7 presents the effect of different land-use characteristic on the NO<sub>2</sub> concentration.

For impervious surfaces, for all three cases, we can clearly see there is a trend that with the increase of impervious surfaces around the station, the concentration of NO<sub>2</sub> increases gradually (Figure 2). As the impervious surface increases, it indicates there is increase in roads, sidewalks, parking lots, buildings, traffic and also there is decrease in vegetation areas and soil surface. Therefore, all these impervious surfaces are kind of indicator of high volume of vehicles, high population density which contributes to high NO<sub>2</sub> emission and also the absence of natural filtration effect with the absence of vegetation is another major source of NO<sub>2</sub> emission.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%202.PNG?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 2:</strong> Variation of measured NO<sub>2</sub> concentration with the impervious surface at 100m, 5000m and 10000m radius around the monitor station.</figcaption>
</figure>


In case of Major roads, we clearly see with the increasing length of major roads, there is clear increase in the concentration of NO<sub>2</sub> (Figure 3). Moreover, visually, it looks like there is a steep increase in the concentration of NO<sub>2</sub> initially with the increase of major roads, but the rate of increase slows down as the length of major roads increases further. The reason of such increase is understandable since the production of NO<sub>2</sub> is directly influenced by the volume of traffic and high traffic areas will release more NO<sub>2</sub> as the more diesel vehicles will be on the road contributing to high NO<sub>2</sub> emissions. Similar trend is observed for the relationship between NO<sub>2</sub> concentration and residential roads and total roads (Figure 4-5).

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%203.PNG?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 3:</strong> Variation of measured NO<sub>2</sub> concentration with the length of major roads at 100m, 5000m and 10000m radius around the monitor station.</figcaption>
</figure>


<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%204.PNG?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 4:</strong> Variation of measured NO<sub>2</sub> concentration with the length of total roads at 100m, 5000m and 10000m radius around the monitor station.</figcaption>
</figure>


<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%205.PNG?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 5:</strong> Variation of measured NO<sub>2</sub> concentration with the length of residential roads at 100m, 5000m and 10000m radius around the monitor station.</figcaption>
</figure>


In case of population, it looked like an exponential curve which might describe the pattern very well where initially with the increase in population there is a drastic increase in NO<sub>2</sub> concentration which saturates at a certain point (Figure 6).

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%206.PNG?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 6:</strong> Variation of measured NO<sub>2</sub> concentration with the population at 100m, 5000m and 10000m radius around the monitor station.</figcaption>
</figure>


Figure 7 shows the relationship between NO<sub>2</sub> concentration and the distance from the coast. In general, as the distance from the coast will be less, there should be lower concentration of NO<sub>2</sub> due to the ventilation from the winds. However, in the figure we can clearly see higher concentration of NO<sub>2</sub> in some of the places which are closest to coast. It indicates that although coastal distance have effect on NO<sub>2</sub> but it should be analyzed in combination with other land use pattern because even if the place is closer to coast but if there is high population density and roads, it will have higher NO<sub>2</sub>. 
Overall, all of these land-use characteristics have their own effect on the NO<sub>2</sub> concentration and in some cases, there is strong relationship with NO<sub>2</sub>.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%207.PNG?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 7:</strong> Variation of measured NO<sub>2</sub> concentration with the distance to coast from the monitor station.</figcaption>
</figure>


As a next step, we also investigated the scenario of NO<sub>2</sub> concentration at individual state level and for the preliminary analysis we selected four states- IL, CA, FL and ND. The reason of selecting these four states was to capture the diverse representation of factors that might influence the NO<sub>2</sub> level which might be helpful for generalizing our analysis in future. CA is a highly urbanized and densely populated state with around 94 station available at the given dataset which is the reason we considered CA for our analysis. IL offers a perspective in the NO<sub>2</sub> pattern of Midwest’s urban and suburban areas whereas FL is a coastal state which might help to understand the effect of breeze and humidity on NO<sub>2</sub>. Lastly, ND is a low-population and rural environment with minimal urbanization which might help us to understand the effect of such characteristics on NO<sub>2</sub>. The effect of the land use characteristics described earlier on NO<sub>2</sub> concentrations are summarized in Figure 8-15. Figure 16 presents the distribution of NO<sub>2</sub> pollutants of these states by monitoring station.

For CA state, visually we can clearly see there exists a correlation among impervious surface, population, length of the roads and NO2 concentration (Figure 8-9). Interesting to see, although some of the places are very closer to the coast but it has significant concentration of NO<sub>2</sub>. As discussed earlier, although the coastal distance is lower but other factors such as impervious area, population and length of the roads are so high that it affects the NO<sub>2</sub> significantly compared to the coastal distance from measuring station. 

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%208.PNG?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 8:</strong> Effect of different land use characteristics on NO<sub>2</sub> concentration of CA state.</figcaption>
</figure>


<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%209.png?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 9:</strong> Heatmap to understand the effect of different land use characteristics on NO<sub>2</sub> concentration of CA state.</figcaption>
</figure>


For IL state, there were only 6 stations, and the results suggests that there is a good relationship between impervious surface and NO<sub>2</sub> concentrations (Figure 10-11) . Also, since IL is far away from the coast it is clearly seen that NO<sub>2</sub> concentration has kind of linear relationship with coastal distance. Population and residential roads don’t reveal any clear pattern but with the major roads, it is clearly visible that increase in the length of major roads correlates well with the increase in NO<sub>2</sub> concentrations. 


<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%2010.PNG?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 10:</strong> Effect of different land use characteristics on NO<sub>2</sub> concentration of IL state.</figcaption>
</figure>


<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Figure%2011.png?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 11:</strong> Heatmap to understand the effect of different land use characteristics on NO<sub>2</sub> concentration of IL state.</figcaption>
</figure>


For FL state, impervious surface, population, roads all these parameters have kind of steady linear relationship with NO2 concentration and with the increase in these parameters NO<sub>2</sub> increase is not that significant (Figure 12-13). For example, in IL state, some of the places with 70-80% impervious area has around 30 ppb NO<sub>2</sub> concentration whereas in FL, places with 60-80% impervious area has around 12 ppb NO<sub>2</sub>. One of the major reason of this observed lower values could be due to the fact that all the stations in FL area are very close to the coast showing the noticeable effect of it on NO<sub>2</sub>.


<figure style="text-align: center;">
    <img src="https://raw.githubusercontent.com/uiceds/project-team492/refs/heads/main/content/images/Figure%2012.PNG" alt="Sample Image">
    <figcaption><strong>Figure 12:</strong> Effect of different land use characteristics on NO<sub>2</sub> concentration of FL state. </figcaption>
</figure>


<figure style="text-align: center;">
    <img src="https://raw.githubusercontent.com/uiceds/project-team492/refs/heads/main/content/images/Figure%2013.png" alt="Sample Image">
    <figcaption><strong>Figure 13:</strong> Heatmap to understand the effect of different land use characteristics on NO<sub>2</sub> concentration of FL state. </figcaption>
</figure>


In case of ND state, although it is very far from the coast but still it has very low concentration of NO<sub>2</sub> (highest being ~6%) (Figure 14-15). It could be attributed to the fact that all the stations had very low population and the length of the roads are the lowest among all the four states considered in the preliminary analysis. Overall, it is seen that out of all the land use characteristic considered, all of the factors do not have similar effect on NO2 concentration, and the effect varies from state to state.   


<figure style="text-align: center;">
    <img src="https://raw.githubusercontent.com/uiceds/project-team492/refs/heads/main/content/images/Figure%2014.PNG" alt="Sample Image">
    <figcaption><strong>Figure 14:</strong>  Effect of different land use characteristics on NO<sub>2</sub> concentration of ND state. </figcaption>
</figure>


<figure style="text-align: center;">
    <img src="https://raw.githubusercontent.com/uiceds/project-team492/refs/heads/main/content/images/Figure%2015.png" alt="Sample Image">
    <figcaption><strong>Figure 15:</strong>Heatmap to understand the effect of different land use characteristics on NO<sub>2</sub> concentration of ND state. </figcaption>
</figure>


<figure style="text-align: center;">
    <img src="https://raw.githubusercontent.com/uiceds/project-team492/refs/heads/main/content/images/Figure%2016.png" alt="Sample Image">
    <figcaption><strong>Figure 16:</strong>Distribution of NO<sub>2</sub> concentration across CA, ND, IL, FL based on the station. </figcaption>
</figure>

# {.page_break_before}
__Predictive Modeling__ 

Based on the preliminary analysis of our dataset, it is evident that all these land-use parameters, such as impervious surfaces, road density, population distribution, etc. play a crucial role in shaping NO₂ concentrations. These parameters exhibit a strong correlation with NO₂ levels, underscoring their significance as predictors. Our next objective is to quantify the specific effects of each land-use parameter on NO₂ concentration and identify which factors most significantly influence these levels. By pinpointing the primary contributors, we aim to refine our understanding of pollution sources and dispersion. 

Building on these findings, we will develop a predictive regression model capable of estimating NO₂ concentrations across different states in the U.S., factoring in the varying land-use patterns with high accuracy. For developing this model, we will consider interaction terms such as population density x road, impervious surface x major roads etc to capture the combined effects of multiple variables. We will do further correlation analysis to identify strong predictors of NO<sub>2</sub> emissions. Using PCA, we will try to reduce dimensionality if there are many correlated features simplifying the model without losing the predictive capacity. Then, we will explore different machine learning algorithms to find out which one works better for our purpose, followed by model training and cross-validation. We will consider different performance metrics like R-square, Root mean squared error values etc. to evaluate the model accuracy. Eventually, we will apply the model to predict NO<sub>2</sub> levels in regions that do not have measured data on NO<sub>2</sub> but have land-use information.  

Such a model has the potential to be instrumental for multiple applications. By assessing long-term health impacts associated with chronic exposure to pollutants, it can provide insights into the risk of respiratory and cardiovascular conditions associated with NO₂. This type of analysis is invaluable to public health agencies tasked with identifying regions and populations at greater risk of pollutant-related diseases [5-6]. Moreover, predictive modeling of NO₂ concentrations can guide policymakers and city planners in designing urban environments with better air quality. By predicting pollutant dispersion, decision-makers can strategically zone residential areas, schools, and recreational spaces away from high pollution zones, thus enhancing community health and safety. Finally, our model will help highlight areas where pollution levels are worsening, providing actionable insights for immediate interventions. This capability will empower environmental agencies to prioritize regions for pollution control efforts, thus contributing to a healthier and more sustainable living environment for all residents. 
</p>


## Predictive Modeling {.page_break_before}
   
__Description and Characterization of Dataset__ 

<p style="text-align:justify;">

In the predictive modeling, machine learning was used to make a predictive model of the dataset. The sequence of this project was as follows: 1. Data selection and clearing 2. Machine learning - 2.1 Normalization and Regularizatioon, 2.2 Perform analysis 2.3 Check the validity. In conclusion, all machine learning techniques were compared in terms of accuracy, speed, and simplicity. 

__Data selection and coordinate transform__

First, the data was sorted by using the correlation plot. Since there were numerous variables in the dataset, selective dependent variables introduced in the exploratory data analysis section were also used for the machine learning. This contains distance to coast, Impervious 100, Impervious 5000, Impervious 10000, Population 100, Population 5000, Population 10000, Major 100, Major 5000, Major 10000, Residential 100, Residential 5000, Residential 10000, Total 100, Total 5000, Total 10000.

The correlation comparison was segmented into five different groups at first, since to visually inspect, it was impossible to compare all. Also, depending on the naming (i.e. impervious), this process was expected to classify necessary data. Figure 1 shows the results of each correlation plot.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Pro3_1.jpg?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 1:</strong> Correlations of each dependent variables</figcaption>
</figure>

As per the correlation plots, it was assumed that as the color of the curves get darker. By comparing all, it was concluded that distance to coast, impervious 100, major 100, major 5000, resident 100, resident 5000, total 100, and total 5000 have less correlation. This was reanalyzed through correlation plotting as shown in figure 2 to be more accurate.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Pro3_2.jpg?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 2:</strong> Reanalyze and final correlation checking </figcaption>
</figure>

For selecting the most relevant features to predict observed NO2 concentrations, Lasso Regression (Least Absolute Shrinkage and Selection Operator) was applied to the dataset to reduce complexity by shrinking less important feature coefficient to zero. The reason of selecting Lasso was as it performs both feature selection and regularization, simplifying the model by irrelevant and redundant features.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Lasso%20Code.png?raw=true">
    <figcaption><strong>Figure 3:</strong> Lasso Regression code used for selecting the input features for predictive modeling.</figcaption>
</figure>

Lasso Regression along with cross-validation was applied that performs k-fold cross-validation (which is by default 10) to find the optimal regularization parameter, lambda. Alpha value of 1.0 specifies exactly Lasso regularization rather than Ridge or elastic net. Thereafter, using the best lambda value, a new Lasso model was fit which enable the model to learn the optimal coefficient for selected features. Finally, coefficient of features was evaluated and non-zero coefficients were calculated by Lasso for using the selected features for further modelling. 

| Sl. No |           Selected Features          |  Coefficients  |
|:-------|:-------------------------------------|:---------------|
|    1   |         Distance_to_coast_km         |    1.035150    | 
|    2   |            Impervious_100            |    1.396751    | 
|    3   |            Impervious_1800           |    0.919251    | 
|    4   |            Impervious_10000          |    0.510092    | 
|    5   |        Elevation_truncated_km        |    1.123214    | 
|    6   |               Major_100              |    0.298449    | 
|    7   |               Major_5000             |    0.324849    | 
|    8   |              Resident_100            |    1.082713    | 
|    9   |              Resident_5000           |    1.235198    | 
|   10   |                total_100             |    0.112781    | 
|   11   |               total_5000             |    0.175802    | 
|   12   |             Population_10000         |    0.076178    | 

For training and test data distribution, 80/20 ratio was followed where 80% of data points were considered training data and rest of the data points were test data. Out of 369 observations in the dataset, first 300 points were training data and rest of the data points were testing data. Model was first trained on training data and then the model was applied on testing data to find the efficiency of the predictive model.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Pro3_3.jpg?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 4:</strong> Dataset used in this project: first 300 rows were considered as training data and rest of the 69 points were testing data. </figcaption>
</figure>

__Predictive Modeling: Machine learning__

Four different machine learning analysis was performed to build a predictive model: linear regression, decision tree, random forest regression and neural network.

1. Linear regression
   
The first method used for prediction was linear regression model. This method is quite simple but it would give us a sense of machine learning and the complexity needed for training data. THe dataset shown in Figure 3 was used as a training set and dataset shown in Figure 4 was used as a testing set. Mean squared error was used to minimize the error and in the linear model and independent variable and gradient descent parameter was used in the model structure. The training set was standardized and normalized to enhance the accuracy of prediction. Figure 5 shown the main flow of the coding.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Pro3_5_1.jpg?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 5:</strong> Linear regression code flow </figcaption>
</figure>

After training, the dataset was trained as shown in Figure 6. By performing root mean square error, the scoring was 4.3. Still, it is not as low as expected. For future modeling, more dataset could be used for higher accuracy, polymodel rather than linear model can be tried.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Pro3_5.jpg?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 6:</strong> Linear regression result </figcaption>
</figure>

2. Decision tree

Decision tree was also used for predicting the dataset. Six variables that were assigned in the dataset selection, each were gini plotted for setting up the baselines. Figure 7 shows the code flow and Figure 8 shows the gini plot with each variable. Dependeing on the ppb value, <10 was decided to be low, >20 was decided to be high, and between that was decided to be medium. These values are the dominant range of ppb level in all states.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Pro3_6_1.jpg?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 7:</strong> Decision tree code flow </figcaption>
</figure>

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Pro3_6.jpg?raw=true" alt="Sample Image">
    <figcaption><strong>Figure 8:</strong> Gini plot for six variables </figcaption>
</figure>

With comparing all plots, the cutting points were decided as: 1) Distance to coast (km) > 1500 : low, Distance to coast (km) < 100 : high, Impervious_100 < 20 : low, Impervious 100 > 60 : high, Major 5000 > 200 : high, Major 5000 < 50 : low, Resident 5000 < 200 : low, else : medium (Figure 7).

The model's precision was calculated by measuring recall divided by the average of the prevision and recall, which got value of 0.078. Decision tree method was proven to be quite accurate is classifying NO2 pollutant value in high, medium, and low range.

3. Random forest Regressor
   
Random forest is an ensemble learning method that aggregates predictions from multiple decision trees to reduce overfitting and improve generalization. Some key parameters of this algorithm are:

a) n_trees: It specifies the number of trees in the forest. A large number improves the stability and reduces variance but increases computational cost. Considering all these factors, the value of n_trees were considered 200 in this project.

b) max_depth: It limits the minimum number of samples required to split and internal node. A depth of 20 is considered in this study which is suitable for capturing complex pattern of land use pattern and correlation with NO2 data without overfitting.

c) min_samples_split: It is the value of minimum number of samples that are required to split an internal node. The large values prevent overfitting by avoiding overly specific splits. A value of 15 was considered in the model.

d) min_samples_leaf: The minimum number of samples required to be at a leaf node which ensures that leaf nodes represent significant data, improving model generalization. 

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/RF%20code.png?raw=true">
    <figcaption><strong>Figure 9:</strong> Random Forest Regressor code that is used for devloping the predictive model </figcaption>
</figure>

Firstly, the features were standardized by subtracting the mean and dividing by the standard deviation for each column. This ensures that all features are on the same scale, preventing dominance of features with large numerical ranges during model training. For the analysis, DecisionTree package of Julia was used A typical 80/20 split for training and testing is used to evaluate the model’s generalization on unseen data. As an evaluation metric, means squared error (MSE), root mean squared error (RMSE) and R2 score was used for assessing the accuracy of the predictive modelling.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Random%20Forest%201.png?raw=true">
    <figcaption><strong>Figure 10:</strong> Comparison between the NO2 values predicted from Random Forest Regressor model and the observed NO2 values for all the training and test data.  </figcaption>
</figure>

For this predictive model, MSE value was 12.82, RMSE value was 3.58 and R2 value of 0.54 was obtained. While R2 value of ~0.54 suggests moderate predictive ability, the remaining 40% of the unexplained variance indicates the room for improvement. Potential area for optimizing and improving the models are optimizing the Random Forest hyperparameteres, using alternative and strong algorithms like Gradient Boosting etc. Moreover, Since there were quite a large number of independent variables, feature selection also needs to be analyzed more cautiously. However, given the complexity of the given environmental data, R2 value of 0.54 can be considered a moderate one.

4. Neural Network Algorithm
   
A neural network is a computational model which is inspired by the human brain, consists of layers of interconnected neurons. It is commonly used to learn patterns and relationships in a dataset. This model has been applied to explore its predictive capability compared to other techniques used. 

The main neural network architecture has been defined using the chain structure which takes 12 features as input and passes them to first hidden layer. Three hidden layers have been added with 128, 64 and 32 neurons along with ReLU activation. Dropout of 0.5 has been kept to drop 50% of the neuron randomly to prevent overfitting. A single neuron outputs the predicted NO2 value. To minimize the loss function, MSE and L1 regularization has been incorporated in the code. L1 regularization penalty adds a penalty proportional to the absolute values of the model’s weights.

The training process is conducted updating the model’s weights to minimize the loss function where descent optimizer was used to update the model’s weights using gradient descent with a fixed learning rate of 0.001. The model is set for 500 epochs and Flux.train! has been used to compute the loss function with respect to model weights. The Flux package in Julia has been utilized for this modelling.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/nn%20code.png?raw=true">
    <figcaption><strong>Figure 11:</strong> Neural Network Model code that is used for devloping the predictive model </figcaption>
</figure>

For this predictive model, MSE value was 10.61, RMSE value was 3.12 and R2 value of 0.61 was obtained. Although the R2 value increased compared to other predictive models, it is still very low compared to the predicted accuracy for neural network model. Potential improvement scope would be to tune the number of layers, neurons and learning rates. Adding additional L2 penalty might be helpful to optimize the model. Evaluating the model’s generalizability with k-fold cross validation might be another option to fine tune the model. But most importantly, selecting the proper input feature might be the most important one which would determine the better prediction accuracy. While revising and optimizing the predictive model, we will try to use feature importance, PCA and other methods to select the proper input features for modelling.

<figure style="text-align: center;">
    <img src="https://github.com/uiceds/project-team492/blob/main/content/images/Neural%20Network.png?raw=true">
    <figcaption><strong>Figure 12:</strong> Comparison between the NO2 values predicted from Neural Network model and the observed NO2 values for all the training and test data. </figcaption>
</figure>


__Comparison Among Different Predictive Models__

The analysis utilized four predictive modeling techniques to predict NO2 concentrations using a dataset of various land use pattern in different locations across US. The evaluation metrics of all the predictive models used in the analysis are summarized in the table below. The accuracy of the predictive model is as follows: Neural Network model > Random Forest Regression > Linear Regression. It is expected that linear regression will be poor fit for this dataset because of the complexity of the dataset and non-linear correlation between the independent variables and NO2 concentrations. Random Forest model with R2 value of 0.54 suggested a moderate predictive capability whereas R2 value of Neural Network model indicates that it explained 61% of the variance in NO2 concentration. These results highlight the importance of accounting for the non-linear interactions and feature complexities  when modeling NO2 concentrations, with Neural Network demonstratiing their strength in capturing such patterns. In the current analysis, Neural network model did not enhance the predictive capability that much and the reason could be due to highly non-linear relationships between the features which reduced the advantage of applying neural network model. Moreover, the number of observation ~370 might not be enough data to effectively learn complex patterns and even with L1 penalties, overfitting might be an issue. However, further improvements could be made in optimizing the predictive model specially in terms of feature selections and explore other advanced ensemble methods to enhance predictive accuracy and generalizability.  

| Sl. No |   Technique of the Predictive Model  |   MSE/Precision | RMSE | R2 |
|:-------|:-------------------------------------|:----------------|:-----|:---|
|    1   |            Linear Regression         |      18.49      | 4.30 |0.41|
|    2   |             Decision Tree            |       0.08      |  --  | -- |
|    3   |        Random Forest Regression      |      12.82      | 3.58 |0.54| 
|    4   |             Neural Network           |      10.61      | 3.12 |0.61|


## References {.page_break_before}

<!-- Explicitly insert bibliography here -->
<div id="refs"></div>

[1]	M.J. Bechle, D.B. Millet, J.D. Marshall, National Spatiotemporal Exposure Surface for NO2: Monthly Scaling of a Satellite-Derived Land-Use Regression, 2000–2010, Environ Sci \& Technol. 49 (2015) 12297–12305. doi:10.1021/acs.est.5b02882.


[2]	L. Smith, S. Mukerjee, K. Kovalcik, E. Sams, C. Stallings, E. Hudgens, J. Scott, T. Krantz, L. Neas, Near-road measurements for nitrogen dioxide and its association with traffic exposure zones, Atmos Pollut Res. 6 (2015) 1082–1086. doi:https://doi.org/10.1016/j.apr.2015.06.005.

[3]	G. Hoek, R. Beelen, K. de Hoogh, D. Vienneau, J. Gulliver, P. Fischer, D. Briggs, A review of land-use regression models to assess spatial variation of outdoor air pollution, Atmos Environ. 42 (2008) 7561–7578. doi:https://doi.org/10.1016/j.atmosenv.2008.05.057.

[4]	E. V Novotny, M.J. Bechle, D.B. Millet, J.D. Marshall, National Satellite-Based Land-Use Regression: NO2 in the United States, Environ Sci \& Technol. 45 (2011) 4407–4414. doi:10.1021/es103578x.

[5]	H. Saki, G. Goudarzi, S. Jalali, G. Barzegar, M. Farhadi, I. Parseh, S. Geravandi, S. Salmanzadeh, F. Yousefi, M.J. Mohammadi, Study of relationship between nitrogen dioxide and chronic obstructive pulmonary disease in Bushehr, Iran, Clin Epidemiol Glob Heal. 8 (2020) 446–449. doi:https://doi.org/10.1016/j.cegh.2019.10.006.

[6]	J.E. Hart, J.D. Yanosky, R.C. Puett, L. Ryan, D.W. Dockery, T.J. Smith, E. Garshick, F. Laden, Spatial Modeling of PM10 and NO2 in the Continental United States, 1985\&\#x2013;2000, Environ Health Perspect. 117 (2009) 1690–1696. doi:10.1289/ehp.0900840.



